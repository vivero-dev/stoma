---
/**
 * EditorLink - renders a styled link that opens the full-page editor
 * with pre-populated code.
 *
 * Zero hydration cost (pure Astro component). The base64 encoding
 * happens at build time so no client-side JS is needed.
 */
// biome-ignore lint/correctness/noUnusedVariables: Astro uses Props implicitly via Astro.props
interface Props {
  /** TypeScript source code to pre-load in the editor. */
  code: string;
  /** Button label text. */
  label?: string;
  /** Title shown in the editor header bar. */
  title?: string;
}

// biome-ignore lint/correctness/noUnusedVariables: label is used in the Astro template below
const { code, label = "Open in Editor", title } = Astro.props;

// Use TextEncoder for Unicode-safe base64 (btoa only handles Latin1)
const encoded = Buffer.from(code, "utf-8").toString("base64");
const params = new URLSearchParams({ code: encoded, autorun: "true" });
if (title) params.set("title", title);
// biome-ignore lint/correctness/noUnusedVariables: used in the Astro template
const href = `/editor?${params.toString()}`;
---

<a href={href} class="editor-link" target="_blank" rel="noopener">
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="16"
    height="16"
    viewBox="0 0 24 24"
    fill="none"
    stroke="currentColor"
    stroke-width="2"
    stroke-linecap="round"
    stroke-linejoin="round"
    aria-hidden="true"
  >
    <polyline points="16 18 22 12 16 6"></polyline>
    <polyline points="8 6 2 12 8 18"></polyline>
  </svg>
  {label}
</a>

<style>
  .editor-link {
    display: inline-flex;
    align-items: center;
    gap: 0.375rem;
    padding: 0.375rem 0.75rem;
    border-radius: 0.375rem;
    background: var(--sl-color-accent-low, #1e293b);
    color: var(--sl-color-accent-high, #93c5fd);
    font-size: 0.8125rem;
    font-weight: 500;
    text-decoration: none;
    transition: background 0.15s, color 0.15s;
    border: 1px solid var(--sl-color-accent, #3b82f6);
    margin: 0.5rem 0;
  }

  .editor-link:hover {
    background: var(--sl-color-accent, #3b82f6);
    color: var(--sl-color-white, #fff);
  }

  .editor-link svg {
    flex-shrink: 0;
  }
</style>
